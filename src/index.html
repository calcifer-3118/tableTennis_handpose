<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Table Tennis</title>
    <!-- ModelViewer -->
    <script type="module" src="https://unpkg.com/@google/model-viewer/dist/model-viewer.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.14.0/css/all.min.css" integrity="sha512-1PKOgIY59xJ8Co8+NE6FZ+LOAZKjy+KY8iq0G4B3CyeY6wYHN3yt9PW0XpSriVlkMXe40PTKnXrLnZ9+fkDaog==" crossorigin="anonymous" />
    <style>
        model-viewer{
            width: 100vw;
            height: 100vh;
        }
        </style>

</head>
<body>
    <canvas class="webgl"></canvas>
    <canvas class="canvas"></canvas>
    <video class="video"></video>
    
    <div class="score">
        <div class="p1">
            <div class="conatiner">
                <div class="p1_name">Player 1</div>
            </div>
            <div class="progress_p1">
            <div class="progress-done_p1" data-done="50">
            </div>
            </div>
        </div>

        <div class="scoreNumber">
            <h1 class="p1_num" style="color: aliceblue; font-size:50px;">0 &#160 &#160 &#160</h1>
            <h1 style="color: beige; font-size:50px;"> : &#160 &#160 &#160</h1>
            <h1 class="p2_num" style="color: aliceblue; font-size:50px;">0</h1>
        </div>

        <div class="gameWon">
            <div class="gameWon_text">0</div>
        </div>

        <div class="p2">
            <div class="conatiner">
                <div class="p2_name">AI</div>
            </div>
            
            <div class="progress_p2">
            <div class="progress-done_p2" data-done="50">
            </div>
            </div>
        </div>


    </div>

    <link rel="preconnect" href="https://fonts.gstatic.com">
<link href="https://fonts.googleapis.com/css2?family=Fira+Sans:ital,wght@0,300;1,300&display=swap" rel="stylesheet">

<div class="card-container">
    <div class="card">
      
        <div class="options">
       
            <div class="slider-container">
                <div class="slider-bar"> <p class="slider_p"> Difficulty </p> </div>
                
                <svg class="slider-progress" viewBox="0 0 51 6">
                    <path class="progress-path" xmlns="http://www.w3.org/2000/svg" d="M 13 3 L 20.5 3 Q 22 3 23 1" stroke="#5a38e0" stroke-width="1" fill="none" stroke-linecap="round"/>
                </svg>
                <div class="slider-circle" style="transform: translate(-50%, -50%) translateX(-2.5rem); top: 1em;">
                    <div class="slider-text">0</div>
                </div>
                <input type="range" class="slider" value="400" min="-400" max="1400">
            </div>
           
            <div class="music"> 
                <i class="fas fa-volume-mute" style="color: rgb(158, 136, 107); margin-right: 22px; margin-top: -3px; font-size: 30px; display: none;"></i>
                <i class="fas fa-volume-up" style="color: rgb(158, 136, 107); margin-right: 22px; margin-top: -3px; font-size: 30px;"></i>
                <label class="switch">
                    <input class="checkbox" type="checkbox" checked onchange="doalert(this)">
                    <div>
                        <span></span>
                    </div>
                </label>
            </div>
           
        </div>
        
  </div>
</div>

    <div class = 'search-box'>
        <input class = "search-text" type="text" placeholder = "Enter your GameTag...">
      <a href="#" class = "search-btn">
        <i class="fas fa-gamepad"></i>
      </a>
    </div>


    <div class="card-container_htp">
        <div class="card">
            <h1>How To Play</h1>
            <script src="https://unpkg.com/@lottiefiles/lottie-player@latest/dist/lottie-player.js"></script>
            <lottie-player src="https://assets2.lottiefiles.com/packages/lf20_empnvxc1.json"  background="transparent"  speed="1"  style="width: 400px; position: absolute; top: -25%; left: 35%;"  loop autoplay></lottie-player>
            <p class="htp_p" style="padding: 30px; margin:4px">Make sure you have a supported webcam and permissions for the webcam are granted. <br>Control the racket with your hand by moving it in front of the camera. Do a serve by pushing your hand forward.</p>
            <div class="svg-wrapper">
                <svg height="40" width="150" xmlns="http://www.w3.org/2000/svg">
                  <rect id="shape" height="40" width="150" />
                  <div id="text">
                    <a onclick="window.loadGame()"><span class="spot"></span>Lets' Go</a>
                  </div>
                </svg>
              </div>
        </div>
    </div>



   

    <model-viewer bounds="tight" src="/models/scene.glb" ar ar-modes="webxr scene-viewer quick-look" camera-controls environment-image="neutral" shadow-intensity="1.32" auto-rotate shadow-softness="1" camera-orbit="-324.3deg 72.61deg auto" min-camera-orbit="auto 33deg 12.14m" max-camera-orbit="auto 80deg auto" min-field-of-view="38.09deg">
        <button class="Hotspot" slot="hotspot-6" data-position="1.718199752457908m 1.7952758726521125m 0.9350524396117248m" data-normal="-0.7015896328786082m 0m -0.7125812143449055m" data-visibility-attribute="visible">
        <div class="HotspotAnnotation" onclick="loadHTP()">PLAY</div>
        <div class="loader"></div>
        </div>

        </button>
        <div class="progress-bar hide" slot="progress-bar">
            <div class="update-bar"></div>
        </div>

    </model-viewer>

    <script src="https://cdn.jsdelivr.net/npm/@mediapipe/camera_utils/camera_utils.js" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/@mediapipe/control_utils/control_utils.js" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/@mediapipe/drawing_utils/drawing_utils.js" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/@mediapipe/hands/hands.js" crossorigin="anonymous"></script>

    <script>
            
let i = 0;
let inputpos = 0.4;
let offsetY = 0;
const slider = document.querySelector(".slider");
const slidercircle = document.querySelector(".slider-circle");
const slidertext = document.querySelector(".slider-text");
const progresspath = document.querySelector(".progress-path");
let mousedown = false;

const updateCircle = () => {
	// position the circle horizontally
	slidercircle.style.transform = `translate(-50%, -50%) translateX(${inputpos * 18 - 12.5}rem)`;
    
	// position the circle vertically;
    if(inputpos < 0.1)
    {
        inputpos = 0.1;
    }
	else if (inputpos >= 1.05) {
		slidercircle.style.top = "3em";
		slidertext.innerHTML = "10";
	} else if (inputpos <= -0.05) {
		slidercircle.style.top = "3em";
		slidertext.innerHTML = "0";
	} else {
		slidercircle.style.top = `${(Math.round(inputpos * 10) % 2) * 4 + 1}em`;
		slidertext.innerHTML = String(Math.round(inputpos * 10));
	}
	
	// make the path link to the ball
	progresspath.setAttribute("d",
														`M 13 3
														L ${Math.max(inputpos * 25 + 10.5, 13)} 3
														Q ${Math.max(inputpos * 25 + 12, 13)} 3
														${inputpos * 25 + 13} ${getComputedStyle(slidercircle).top.slice(0, -2) / 14.4}`);
}

// detect if the slider is held
slider.onmousedown = function (evt) {
	mousedown = true;
};

slider.addEventListener('touchstart', () => {
	mousedown = true;
});

document.body.onmouseup = function (evt) {
	if (evt.button == 0) { mousedown = false; }
};

slider.addEventListener('touchend', () => {
	mousedown = false;
});

slider.addEventListener("input", (e) => {
	// get the slider value
	inputpos = slider.value * 0.001 ;
	
	// make soft bounds
	if (inputpos < 0) {
		inputpos = 1.25 * Math.pow(inputpos + 0.4, 2) - 0.2;
	}
	if (inputpos > 1) {
		inputpos = -1.25 * Math.pow(inputpos - 1.4, 2) + 1.2;
	}
	
	// update the circle and line position
	updateCircle();
});

// every frame (60 times per second)
setInterval(function () {
	
	// if the slider isnt held
	if (!mousedown) {
		
		// find the closest valid position
		const targetpos = Math.min(Math.max(Math.round(inputpos * 10) / 10, 0), 1);
		
		// softly glide to that position
		if (Math.abs(inputpos - targetpos) < 0.001) {
			inputpos = targetpos;
			slider.value = Math.round(inputpos * 1000);
		} else {
			inputpos = 0.9 * inputpos + 0.1 * targetpos;
			slider.value = Math.round(inputpos * 1000);
		}
	}
	
	// update the circle and the line position
	updateCircle();
	
}, 1000 / 60);
            
    </script>

    <script>
        const cards = document.querySelectorAll(".card");
// const onDocumentMouseMoveHandler = (evt) => {
//   evt.preventDefault();

//   requestAnimationFrame(() => {
//     if (!evt.target.closest('.card')) {
//       card.style.transform = 'perspective(1000px) scale(1) rotateX(0) rotateY(0)';
//     }
//   });
// };
// document.addEventListener('mousemove', onDocumentMouseMoveHandler)
cards.forEach((card) => {
  const height = card.clientHeight;
  const width = card.clientWidth;

  const mouseMoveHandler = (evt) => {
    evt.preventDefault();

    requestAnimationFrame(() => {
      const xRotation = -30 * ((evt.layerY - height / 2) / height);
      const yRotation = 20 * ((evt.layerX - width / 2) / width);

      card.style.transform = `perspective(1000px) scale(1.05) rotateX(${xRotation}deg) rotateY(${yRotation}deg)`;
    });
  };

  card.addEventListener("mousemove", mouseMoveHandler);

  card.addEventListener("mouseenter", (evt) => {
    evt.preventDefault();
    card.addEventListener("mousemove", mouseMoveHandler);
  });

  card.addEventListener("mouseout", (evt) => {
    evt.preventDefault();
    card.style.transform = "perspective(1000px) scale(1) rotateX(0) rotateY(0)";
    card.removeEventListener("mousemove", mouseMoveHandler);
  });
  
 
});

    </script>








    
</body>
</html>